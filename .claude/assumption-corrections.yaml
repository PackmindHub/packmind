# AI Agent Assumption Correction Log
#
# This file captures assumptions about the codebase that AI agents made
# and later discovered were incorrect. It helps identify documentation gaps
# and improves onboarding context for future AI agent sessions.
#
# Review this file periodically to:
# - Understand what's confusing about the codebase
# - Improve CLAUDE.md with better context
# - Identify misleading names or structures to refactor
# - See common onboarding friction points
# - Enhance documentation for humans too
#
# File is managed by the codebase-assumption-capture skill.
# Schema: See .claude/skills/codebase-assumption-capture/SKILL.md

# Example entry showing the skill in action:

- timestamp: 2026-01-09T18:00:00Z
  category: 'structure'
  assumption: 'Example assumption showing the skill format - no real assumption was incorrect here'
  reality: 'This is a placeholder demonstrating the YAML structure'
  discovery_point: 'Created this file as part of skill initialization'
  impact: 'low'
  misleading_signals:
    - 'This is just an example entry'
  documentation_gap: 'No real documentation gap - this demonstrates the format for future entries'
  files_explored:
    - .claude/skills/codebase-assumption-capture/SKILL.md
  tags:
    - 'example'
    - 'skill-initialization'

- timestamp: 2026-01-23T14:10:00Z
  category: 'configuration'
  assumption: 'Assumed dist/apps/cli/main.cjs was a self-contained bundle that could run independently without npm install'
  reality: 'The build target uses generatePackageJson: true and marks dependencies as external (via esbuild-publish.config.js), requiring node_modules to be present. The bundle target and build-executable targets are the ones that create fully self-contained artifacts.'
  discovery_point: 'User reported "Cannot find module winston" error when running main.cjs in another project without dependencies installed'
  impact: 'medium'
  misleading_signals:
    - 'File is 34MB suggesting everything is bundled'
    - 'bundle: true in project.json options'
    - 'File has .cjs extension implying standalone CommonJS module'
  documentation_gap: 'CLAUDE.md or CLI README should clarify the difference between build targets: build (npm publish with external deps), bundle (self-contained), build-executable (standalone binary)'
  files_explored:
    - apps/cli/project.json
    - apps/cli/esbuild-publish.config.js
    - packages/logger/package.json
  tags:
    - 'cli'
    - 'build'
    - 'bundling'
    - 'esbuild'
    - 'dependencies'

- timestamp: 2026-02-02T16:05:00Z
  category: 'patterns'
  assumption: 'Assumed the UserMetadata feature was fully implemented and passing based on the handoff document "Known Good State" section stating tests passed'
  reality: 'The build failed because UserOrganizationMembership type was missing createdAt property that GetUserOnboardingStatusUseCase needed for creator detection logic. The schema used WithTimestamps<UserOrganizationMembership> but the type itself did not include createdAt.'
  discovery_point: 'Running nx build accounts revealed TS2339 error: Property createdAt does not exist on type UserOrganizationMembership'
  impact: 'low'
  misleading_signals:
    - 'Handoff document stated "Known Good State" with passing tests'
    - 'Schema uses WithTimestamps wrapper suggesting timestamps exist'
    - 'Other entities have createdAt in their types'
  documentation_gap: 'Handoff documents should verify build success, not just test success. TypeORM schema WithTimestamps wrapper does not automatically add properties to the domain type - both must be updated together.'
  files_explored:
    - packages/types/src/accounts/User.ts
    - packages/accounts/src/infra/schemas/UserOrganizationMembershipSchema.ts
    - packages/accounts/src/application/useCases/getUserOnboardingStatus/GetUserOnboardingStatusUseCase.ts
  tags:
    - 'typeorm'
    - 'typescript'
    - 'domain-types'
    - 'handoff'
    - 'validation'
